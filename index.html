<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manixh OS</title>
    <style>
        /* --- 1. DESKTOP & WALLPAPER --- */
        body {
            margin: 0;
            padding: 0;
            overflow: hidden; /* Prevent scrolling on desktop */
            height: 100vh;
            width: 100vw;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            
            /* BG image */
            background: url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2072&auto=format&fit=crop') no-repeat center center fixed;
            background-size: cover;
            user-select: none; /* Stop user from highlighting desktop text */
        }

        /* --- BIOS POST SCREEN --- */
        #bios-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            color: #aaa;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-sizing: border-box;
            overflow: hidden;
            animation: fadeOut 0.5s ease forwards;
            animation-delay: 4.5s;
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                visibility: hidden;
            }
        }

        .bios-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }

        .bios-title {
            color: #0f0;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .bios-version {
            color: #888;
            font-size: 12px;
        }

        .bios-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .bios-line {
            opacity: 0;
            animation: biosLineAppear 0.1s ease forwards;
        }

        @keyframes biosLineAppear {
            to { opacity: 1; }
        }

        .bios-line.ok::after {
            content: " [ OK ]";
            color: #0f0;
            margin-left: 10px;
        }

        .bios-line.pass::after {
            content: " PASS";
            color: #0f0;
            margin-left: 10px;
        }

        .bios-value {
            color: #ff0;
        }

        .bios-progress {
            margin-top: 10px;
            color: #0ff;
        }

        .bios-footer {
            margin-top: auto;
            padding-top: 10px;
            border-top: 1px solid #333;
            color: #666;
            font-size: 12px;
            text-align: center;
        }

        /* --- 2. DESKTOP ICONS --- */
        .icon-container {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .desktop-icon {
            width: 80px;
            text-align: center;
            cursor: pointer;
            color: white;
            text-shadow: 1px 1px 2px black;
            padding: 10px;
            border-radius: 5px;
            transition: 0.2s;
        }

        .desktop-icon:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .desktop-icon img {
            width: 48px;
            height: 48px;
            margin-bottom: 5px;
        }

        .title-icon {
            width: 16px;
            height: 16px;
            margin-right: 8px;
            vertical-align: middle;
        }

        .snake-title-icon {
            width: 28px;
            height: 28px;
            margin-right: 8px;
            vertical-align: middle;
        }

        /* --- 3. THE WINDOW (Your Shell Container) --- */
        #draggable-window {
            position: absolute;
            top: 10vh;
            left: 20vw;
            width: min(650px, 80vw);
            height: min(450px, calc(100vh - 160px));
            max-height: calc(100vh - 160px);
            background-color: rgba(26, 27, 38, 0.3);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(65, 72, 104, 0.5);
            /* Hidden by default until clicked? Or visible. Let's default visible. */
            z-index: 100;
        }

        /* Window Title Bar (The handle for dragging) */
        #title-bar {
            height: 35px;
            background-color: rgba(36, 40, 59, 0.3);
            border-bottom: 1px solid rgba(65, 72, 104, 0.5);
            border-radius: 8px 8px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            cursor: move; /* Shows the 'move' cursor */
        }

        .window-title {
            color: #c0caf5;
            font-size: 14px;
            font-weight: bold;
        }

        .window-controls {
            display: flex;
            gap: 8px;
        }

        .control-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            font-weight: bold;
            color: white;
        }
        .close-btn { background-color: #ff5f56; }
        .close-btn::after { content: '\00d7'; } /* × symbol */
        .min-btn { background-color: #27c93f; }
        .min-btn::after { content: '\2212'; } /* − symbol */

        /* Window Content (Where your terminal lives) */
        #window-content {
            flex-grow: 1;
            padding: 10px;
            overflow-y: auto; /* Scrollable inside the window */
            font-family: 'Courier New', Courier, monospace;
            color: #7aa2f7;
            font-size: 16px;
            text-shadow: 0 0 20px rgba(122, 162, 247, 0.65);
        }

        /* --- 4. TERMINAL INTERNALS (Your existing CSS) --- */
        .output { white-space: pre-wrap; margin-bottom: 5px; text-shadow: 0 0 20px rgba(122, 162, 247, 0.6); }
        .input-line { display: flex; }
        .prompt { color: #9ece6a; margin-right: 10px; text-shadow: 0 0 20px rgba(158, 206, 106, 0.65); }
        input {
            background: transparent; 
            border: none;
            color: #c0caf5;
            font-family: inherit;
            font-size: inherit;
            flex-grow: 1;
            outline: none;
            text-shadow: 0 0 20px rgba(192, 202, 245, 0.65);
        }
        
        /* Scrollbar styling for the window */
        #window-content::-webkit-scrollbar { width: 10px; }
        #window-content::-webkit-scrollbar-track { background: #1a1b26; }
        #window-content::-webkit-scrollbar-thumb { background: #414868; border-radius: 5px; }

        /* --- 5. MODERN GLASSY TASKBAR --- */
        #taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(2px);
            -webkit-backdrop-filter: blur(2px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            padding: 0 15px;
            box-shadow: 0 -2px 20px rgba(0, 255, 136, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.15);
            z-index: 1000;
        }



        .taskbar-apps {
            display: flex;
            gap: 8px;
            flex-grow: 1;
        }

        .taskbar-button {
            height: 44px;
            min-width: 160px;
            max-width: 220px;
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 12px;
            color: rgba(192, 202, 245, 0.85);
            padding: 0 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.15);
            font-size: 14px;
            font-weight: 600;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
            overflow: hidden;
            white-space: nowrap;
            transition: all 0.3s ease;
            backdrop-filter: blur(20px);
        }

        .taskbar-icon {
            width: 18px;
            height: 18px;
            flex: 0 0 auto;
        }

        .taskbar-button:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .taskbar-button.active {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            box-shadow: 0 4px 20px rgba(0, 255, 136, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.2);
            color: rgba(0, 255, 136, 0.95);
        }

        #taskbar-clock {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-left: auto;
            margin-right: 42px;
            line-height: 1.2;
        }

        #taskbar-clock .clock-time {
            font-size: 16px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.95);
            letter-spacing: 0.3px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        #taskbar-clock .clock-date {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.65);
            font-weight: 400;
            letter-spacing: 0.2px;
            text-shadow: 0 1px 4px rgba(0, 0, 0, 0.15);
        }

        /* --- SNAKE GAME WINDOW --- */
        #snake-window {
            position: absolute;
            top: 10vh;
            left: 30vw;
            width: min(460px, 70vw);
            max-height: calc(100vh - 160px);
            background-color: rgba(26, 27, 38, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: none;
            flex-direction: column;
            border: 1px solid rgba(65, 72, 104, 0.5);
            z-index: 100;
            overflow: hidden;
        }

        #snake-title-bar {
            height: 35px;
            background-color: rgba(36, 40, 59, 0.3);
            border-bottom: 1px solid rgba(65, 72, 104, 0.5);
            border-radius: 8px 8px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            cursor: move;
        }

        #snake-content {
            padding: 15px;
            text-align: center;
        }

        .snake-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 12px;
            gap: 15px;
        }

        .snake-stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px solid rgba(0, 255, 136, 0.3);
        }

        .snake-stat-label {
            color: #888;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
            font-weight: 500;
        }

        .snake-stat-value {
            color: #00ff88;
            font-size: 24px;
            font-weight: 700;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
            text-shadow: 0 0 10px #00ff88;
            letter-spacing: 0.5px;
        }

        #snakeCanvas {
            border: 3px solid #00ff88;
            border-radius: 8px;
            background: transparent;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
            display: block;
            margin: 0 auto;
        }

        .snake-controls {
            margin-top: 15px;
            color: #888;
            font-size: 12px;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
            font-weight: 500;
        }

        .snake-controls span {
            color: #00ff88;
            font-weight: 700;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
        }

        #snakeGameOver {
            position: absolute;
            top: 35px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            border-radius: 0 0 8px 8px;
            z-index: 5;
        }

        .snake-gameover-content {
            text-align: center;
            padding: 30px;
        }

        .snake-gameover-content h2 {
            color: #ff3535;
            font-size: 36px;
            text-shadow: 0 0 20px #f64d4d;
            margin-bottom: 15px;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .snake-final-stat {
            color: #77dd99;
            font-size: 18px;
            margin: 8px 0;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
            font-weight: 600;
        }

        #snakeRestartBtn {
            background: linear-gradient(135deg, #00ff88, #00cc6f);
            border: none;
            color: #000;
            font-size: 16px;
            font-weight: 700;
            padding: 10px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
            text-transform: uppercase;
            margin-top: 15px;
            letter-spacing: 0.5px;
        }

        #snakeRestartBtn:hover {
            background: linear-gradient(135deg, #00cc6f, #00ff88);
        }

        #snakePlayBtn {
            background: linear-gradient(135deg, #00ff88, #00cc6f);
            border: none;
            color: #000;
            font-size: 24px;
            font-weight: 700;
            padding: 15px 40px;
            border-radius: 8px;
            cursor: pointer;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
            text-transform: uppercase;
            margin-top: 20px;
            box-shadow: 0 5px 20px rgba(0, 255, 136, 0.4);
            transition: all 0.3s;
            letter-spacing: 1px;
        }

        #snakePlayBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 255, 136, 0.6);
        }

        #snakePlayBtn:active {
            transform: translateY(0);
        }

        #snakeStartScreen {
            position: absolute;
            top: 35px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 0 0 8px 8px;
            z-index: 5;
        }

        .snake-start-content {
            text-align: center;
            padding: 30px;
        }

        .snake-start-content h2 {
            color: #00ff88;
            font-size: 48px;
            text-shadow: 0 0 20px #00ff88;
            margin-bottom: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
            font-weight: 800;
            letter-spacing: 2px;
        }

        .snake-start-content p {
            color: #888;
            font-size: 16px;
            margin-bottom: 10px;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
            font-weight: 500;
        }

        .snake-start-content p span {
            color: #00ff88;
            font-weight: 700;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Helvetica Neue', sans-serif;
        }

        /* --- RESUME PDF VIEWER WINDOW --- */
        #resume-window {
            position: absolute;
            top: 8vh;
            left: 25vw;
            width: min(800px, 85vw);
            height: min(600px, calc(100vh - 140px));
            max-height: calc(100vh - 140px);
            background-color: rgba(26, 27, 38, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: none;
            flex-direction: column;
            border: 1px solid rgba(65, 72, 104, 0.5);
            z-index: 100;
            overflow: hidden;
        }

        #resume-title-bar {
            height: 35px;
            background-color: rgba(36, 40, 59, 0.3);
            border-bottom: 1px solid rgba(65, 72, 104, 0.5);
            border-radius: 8px 8px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            cursor: move;
        }

        #resume-content {
            flex-grow: 1;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.2);
        }

        #resume-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* --- BREADBOARD LOGIC GATE SIMULATOR --- */
        #breadboard-window {
            position: absolute;
            top: 12vh;
            left: 22vw;
            width: min(860px, 90vw);
            height: min(560px, calc(100vh - 140px));
            max-height: calc(100vh - 140px);
            background-color: rgba(26, 27, 38, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: none;
            flex-direction: column;
            border: 1px solid rgba(65, 72, 104, 0.5);
            z-index: 100;
            overflow: hidden;
        }

        #breadboard-title-bar {
            height: 35px;
            background-color: rgba(36, 40, 59, 0.3);
            border-bottom: 1px solid rgba(65, 72, 104, 0.5);
            border-radius: 8px 8px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            cursor: move;
        }

        .info-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: rgba(122, 162, 247, 0.3);
            border: 1px solid rgba(122, 162, 247, 0.6);
            color: #7aa2f7;
            font-size: 10px;
            font-weight: bold;
            font-family: serif;
            margin-left: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .info-icon:hover {
            background: rgba(122, 162, 247, 0.5);
            box-shadow: 0 0 8px rgba(122, 162, 247, 0.6);
        }

        #datasheet-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .datasheet-content {
            background: #f8f8f8;
            width: 500px;
            max-height: 70vh;
            overflow-y: auto;
            border: 2px solid #333;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
            font-family: 'Courier New', monospace;
            color: #000;
        }

        .datasheet-header {
            background: linear-gradient(180deg, #003366, #004488);
            color: white;
            padding: 20px;
            border-bottom: 3px solid #000;
        }

        .datasheet-logo {
            font-size: 18px;
            font-weight: bold;
            letter-spacing: 2px;
            margin-bottom: 5px;
        }

        .datasheet-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .datasheet-subtitle {
            font-size: 12px;
            opacity: 0.9;
        }

        .datasheet-body {
            padding: 25px;
            background: white;
        }

        .datasheet-section {
            margin-bottom: 20px;
        }

        .datasheet-section-title {
            font-size: 14px;
            font-weight: bold;
            border-bottom: 2px solid #000;
            padding-bottom: 3px;
            margin-bottom: 10px;
        }

        .datasheet-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 8px;
        }

        .datasheet-table td {
            padding: 6px 10px;
            border: 1px solid #ccc;
            font-size: 12px;
        }

        .datasheet-table td:first-child {
            background: #f0f0f0;
            font-weight: bold;
            width: 60%;
        }

        .datasheet-footer {
            background: #f0f0f0;
            padding: 12px 25px;
            border-top: 2px solid #000;
            font-size: 10px;
            text-align: center;
            color: #666;
        }

        .datasheet-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #ff5f56;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            line-height: 24px;
            text-align: center;
        }

        .datasheet-close:hover {
            background: #ff4040;
        }

        #breadboard-content {
            flex: 1;
            padding: 14px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            color: #c0caf5;
        }

        .breadboard-layout {
            display: flex;
            gap: 14px;
            height: 100%;
        }

        .gate-palette {
            width: 180px;
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 12px;
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .gate-title {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.65);
            letter-spacing: 0.6px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .gate-tile {
            height: 54px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: grab;
            transition: all 0.2s ease;
        }

        .gate-tile:active {
            cursor: grabbing;
            transform: translateY(1px);
        }

        .chip {
            position: relative;
            width: 130px;
            height: 48px;
            background: linear-gradient(180deg, #1a1c25, #0d0f16);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 10px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.35), inset 0 1px 0 rgba(255, 255, 255, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 700;
            letter-spacing: 0.6px;
            font-size: 12px;
        }

        .chip::before,
        .chip::after {
            content: "";
            position: absolute;
            top: 6px;
            bottom: 6px;
            width: 8px;
            background: linear-gradient(180deg, #cfd6e0, #8b94a2);
            border-radius: 4px;
            box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.35);
        }

        .chip::before {
            left: -6px;
        }

        .chip::after {
            right: -6px;
        }

        .chip-pins {
            position: absolute;
            top: 6px;
            bottom: 6px;
            left: -12px;
            right: -12px;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
        }

        .chip-pin-stack {
            display: grid;
            grid-template-rows: repeat(4, 1fr);
            gap: 4px;
        }

        .chip-pin {
            width: 6px;
            height: 6px;
            background: linear-gradient(180deg, #e2e6ef, #9aa3b3);
            border-radius: 2px;
            box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.25);
        }

        .chip-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .chip-label .chip-code {
            font-size: 12px;
            color: #c0caf5;
        }

        .chip-label .chip-gate {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.65);
            letter-spacing: 0.4px;
        }

        .breadboard-board {
            flex: 1;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 12px;
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .breadboard-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .toggle-btn {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.18);
            color: rgba(192, 202, 245, 0.9);
            padding: 6px 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .toggle-btn.on {
            background: rgba(0, 255, 136, 0.12);
            border-color: rgba(0, 255, 136, 0.4);
            color: #00ff88;
            box-shadow: 0 0 12px rgba(0, 255, 136, 0.2);
        }

        .toggle-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .clear-btn {
            padding: 10px 20px;
            background: rgba(255, 95, 86, 0.2);
            border: 1px solid rgba(255, 95, 86, 0.5);
            border-radius: 8px;
            color: #ff5f56;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.2s;
        }

        .clear-btn:hover {
            background: rgba(255, 95, 86, 0.3);
            box-shadow: 0 0 10px rgba(255, 95, 86, 0.4);
        }

        .clear-btn:active {
            transform: scale(0.95);
        }

        .breadboard-zone {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            background: rgba(0, 0, 0, 0.15);
            transition: all 0.2s ease;
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
        }

        .breadboard-zone.drag-over {
            border-color: rgba(0, 255, 136, 0.6);
            background: rgba(0, 255, 136, 0.08);
            color: #00ff88;
        }

        .placed-gate {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .slot-hint {
            margin-top: 8px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
        }

        .led-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.7);
        }

        .led-light {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            object-fit: cover;
            filter: drop-shadow(0 0 6px rgba(0, 0, 0, 0.35));
        }

        .led-indicator.on {
            color: #00ff88;
        }

        .led-indicator.on .led-light {
            filter: drop-shadow(0 0 10px rgba(0, 255, 136, 0.8));
        }

        .breadboard-note {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }

        .oscilloscope {
            margin-top: 6px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 8px;
        }

        .oscilloscope-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 6px;
            letter-spacing: 0.6px;
            text-transform: uppercase;
        }

        #breadboard-scope {
            width: 100%;
            height: 140px;
            display: block;
            border-radius: 8px;
            background: #050608;
        }

        /* --- PROCESS MANAGER / TASK MONITOR --- */
        #process-window {
            position: absolute;
            top: 14vh;
            left: 24vw;
            width: min(640px, 80vw);
            height: min(420px, calc(100vh - 170px));
            max-height: calc(100vh - 170px);
            background-color: rgba(26, 27, 38, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: none;
            flex-direction: column;
            border: 1px solid rgba(65, 72, 104, 0.5);
            z-index: 100;
            overflow: hidden;
        }

        #process-title-bar {
            height: 35px;
            background-color: rgba(36, 40, 59, 0.3);
            border-bottom: 1px solid rgba(65, 72, 104, 0.5);
            border-radius: 8px 8px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            cursor: move;
        }

        #process-content {
            flex: 1;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 14px;
            color: #c0caf5;
        }

        .process-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .process-row {
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 12px;
            padding: 12px;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 6px 12px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .process-name {
            font-weight: 700;
            color: rgba(192, 202, 245, 0.95);
            letter-spacing: 0.3px;
        }

        .process-meta {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            text-align: right;
        }

        .process-row.warning .process-meta {
            color: #ffb454;
        }

        .process-bar {
            grid-column: 1 / -1;
            height: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 999px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.12);
        }

        .process-bar-fill {
            height: 100%;
            width: 0;
            background: linear-gradient(90deg, rgba(0, 255, 136, 0.2), rgba(0, 255, 136, 0.85));
            border-radius: 999px;
            transition: width 0.35s ease;
        }

        .process-bar-fill.warning {
            background: linear-gradient(90deg, rgba(255, 180, 84, 0.2), rgba(255, 120, 84, 0.9));
        }

        .process-bar-fill.negative {
            background: linear-gradient(90deg, rgba(120, 160, 255, 0.2), rgba(120, 160, 255, 0.85));
        }

        /* --- START BUTTON SCREEN --- */
        #start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 10001;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 40px;
        }

        .start-button {
            width: 140px;
            height: 140px;
            border: 4px solid #00ff88;
            border-radius: 50%;
            background: rgba(0, 255, 136, 0.1);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3), inset 0 0 20px rgba(0, 255, 136, 0.1);
            padding: 10px;
            box-sizing: border-box;
        }

        .start-button img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .start-button:hover {
            background: rgba(0, 255, 136, 0.2);
            box-shadow: 0 0 40px rgba(0, 255, 136, 0.6), inset 0 0 20px rgba(0, 255, 136, 0.2);
            transform: scale(1.05);
        }

        .start-button:active {
            transform: scale(0.95);
        }

        .start-label {
            color: #666;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
    </style>
</head>
<body>

<!-- Start Button Screen -->
<div id="start-screen">
    <div class="start-label">Press to Start</div>
    <div class="start-button" id="start-button">
        <img src="src/start-button.png" alt="Start button">
    </div>
</div>

<!-- BIOS POST Screen -->
<div id="bios-screen" style="display: none;">
    <div class="bios-header">
        <div class="bios-title">MANIXH SYSTEM BIOS</div>
        <div class="bios-version">Version 2.0.26 - Build 20260131</div>
    </div>
    <div class="bios-content" id="bios-content">
        <!-- BIOS lines will be added dynamically -->
    </div>
    <div class="bios-footer">
        Press DEL to enter SETUP
    </div>
</div>

<div class="icon-container">
    <div class="desktop-icon" onclick="openTerminal()">
        <img src="src/terminal.png" alt="Terminal logo">
        <div>Terminal</div>
    </div>
    <div class="desktop-icon" onclick="openProcessManager()">
        <img src="src/process-manager.png" alt="Process Manager logo">
        <div>Process Manager</div>
    </div>
    <div class="desktop-icon" onclick="openResume()">
        <img src="src/resume.png" alt="Resume logo">
        <div>resume.txt</div>
    </div>
    <div class="desktop-icon" onclick="openBreadboard()">
        <img src="src/breadboard.png" alt="Breadboard logo">
        <div>Breadboard</div>
    </div>
    <div class="desktop-icon" onclick="openSnakeGame()">
        <img src="src/snake.png" alt="Snake logo">
        <div>snake.exe</div>
    </div>
</div>

<div id="draggable-window">
    <div id="title-bar">
        <div class="window-title">guest@manixh:~</div>
        <div class="window-controls">
            <div class="control-btn min-btn" onclick="minimizeTerminal()"></div>
            <div class="control-btn close-btn" onclick="closeTerminal()"></div>
        </div>
    </div>

    <div id="window-content" onclick="document.getElementById('cmdInput').focus()">
        <div id="history">
            <div class="output">Welcome to Manixh OS (v2.0).</div>
            <div class="output">Type 'help' to see a list of commands.</div>
            <br>
        </div>
        <div class="input-line">
            <span class="prompt">guest@manixh:~$</span>
            <input type="text" id="cmdInput" autocomplete="off" autofocus>
        </div>
    </div>
</div>

<div id="snake-window">
    <div id="snake-title-bar">
        <div class="window-title"><img class="title-icon" src="src/snake.png" alt="Snake logo">Snake Game</div>
        <div class="window-controls">
            <div class="control-btn min-btn" onclick="minimizeSnake()"></div>
            <div class="control-btn close-btn" onclick="closeSnake()"></div>
        </div>
    </div>

    <div id="snake-content">
        <div class="snake-stats">
            <div class="snake-stat">
                <div class="snake-stat-label">Score</div>
                <div class="snake-stat-value" id="snakeScore">0</div>
            </div>
            <div class="snake-stat">
                <div class="snake-stat-label">High Score</div>
                <div class="snake-stat-value" id="snakeHighScore">0</div>
            </div>
            <div class="snake-stat">
                <div class="snake-stat-label">Time</div>
                <div class="snake-stat-value" id="snakeTime">0:00</div>
            </div>
        </div>

        <canvas id="snakeCanvas" width="380" height="380"></canvas>

        <div class="snake-controls">
            <span>WASD</span> or <span>Arrow Keys</span>
        </div>

        <div id="snakeStartScreen">
            <div class="snake-start-content">
                <h2><img class="snake-title-icon" src="src/snake.png" alt="Snake logo">SNAKE</h2>
                <p>Use <span>WASD</span> or <span>Arrow Keys</span> to control</p>
                <p>Collect food and avoid walls & your tail</p>
                <p>Speed increases as you score!</p>
                <button id="snakePlayBtn">Play Game</button>
            </div>
        </div>

        <div id="snakeGameOver">
            <div class="snake-gameover-content">
                <h2>GAME OVER</h2>
                <div class="snake-final-stat">Score: <span id="snakeFinalScore">0</span></div>
                <div class="snake-final-stat">High Score: <span id="snakeFinalHighScore">0</span></div>
                <div class="snake-final-stat">Time: <span id="snakeFinalTime">0:00</span></div>
                <button id="snakeRestartBtn">Play Again</button>
            </div>
        </div>
    </div>
</div>

<div id="resume-window">
    <div id="resume-title-bar">
        <div class="window-title"><img class="title-icon" src="src/resume.png" alt="Resume logo">Resume</div>
        <div class="window-controls">
            <div class="control-btn min-btn" onclick="minimizeResume()"></div>
            <div class="control-btn close-btn" onclick="closeResume()"></div>
        </div>
    </div>
    <div id="resume-content">
        <iframe id="resume-iframe" src="resume.pdf"></iframe>
    </div>
</div>

<div id="breadboard-window">
    <div id="breadboard-title-bar">
        <div class="window-title">
            <img class="title-icon" src="src/breadboard.png" alt="Breadboard logo">Breadboard
            <span class="info-icon" onclick="openDatasheet(event)">i</span>
        </div>
        <div class="window-controls">
            <div class="control-btn min-btn" onclick="minimizeBreadboard()"></div>
            <div class="control-btn close-btn" onclick="closeBreadboard()"></div>
        </div>
    </div>
    <div id="breadboard-content">
        <div class="breadboard-layout">
            <div class="gate-palette">
                <div class="gate-title">Logic Gates</div>
                <div class="gate-tile" draggable="true" data-gate="AND">
                    <div class="chip">
                        <div class="chip-pins">
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                        </div>
                        <div class="chip-label">
                            <div class="chip-code">74LS08</div>
                            <div class="chip-gate">AND</div>
                        </div>
                    </div>
                </div>
                <div class="gate-tile" draggable="true" data-gate="OR">
                    <div class="chip">
                        <div class="chip-pins">
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                        </div>
                        <div class="chip-label">
                            <div class="chip-code">74LS32</div>
                            <div class="chip-gate">OR</div>
                        </div>
                    </div>
                </div>
                <div class="gate-tile" draggable="true" data-gate="XOR">
                    <div class="chip">
                        <div class="chip-pins">
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                        </div>
                        <div class="chip-label">
                            <div class="chip-code">74LS86</div>
                            <div class="chip-gate">XOR</div>
                        </div>
                    </div>
                </div>
                <div class="gate-tile" draggable="true" data-gate="XNOR">
                    <div class="chip">
                        <div class="chip-pins">
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                        </div>
                        <div class="chip-label">
                            <div class="chip-code">74LS266</div>
                            <div class="chip-gate">XNOR</div>
                        </div>
                    </div>
                </div>
                <div class="gate-tile" draggable="true" data-gate="NAND">
                    <div class="chip">
                        <div class="chip-pins">
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                        </div>
                        <div class="chip-label">
                            <div class="chip-code">74LS00</div>
                            <div class="chip-gate">NAND</div>
                        </div>
                    </div>
                </div>
                <div class="gate-tile" draggable="true" data-gate="NOR">
                    <div class="chip">
                        <div class="chip-pins">
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                        </div>
                        <div class="chip-label">
                            <div class="chip-code">74LS02</div>
                            <div class="chip-gate">NOR</div>
                        </div>
                    </div>
                </div>
                <div class="gate-tile" draggable="true" data-gate="NOT">
                    <div class="chip">
                        <div class="chip-pins">
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                            <div class="chip-pin-stack">
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                                <span class="chip-pin"></span>
                            </div>
                        </div>
                        <div class="chip-label">
                            <div class="chip-code">74LS04</div>
                            <div class="chip-gate">NOT</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="breadboard-board">
                <div class="breadboard-controls">
                    <button class="toggle-btn" data-input="A">A: OFF</button>
                    <button class="toggle-btn" data-input="B">B: OFF</button>
                    <button class="clear-btn" onclick="clearBoard()">Clear Board</button>
                </div>
                <div class="breadboard-zone" id="breadboard-zone">
                    <div class="breadboard-slot" id="breadboard-slot">
                        <div>Drop a gate here</div>
                        <div class="slot-hint">Drag AND, OR, XOR, XNOR, NAND, NOR, or NOT</div>
                    </div>
                </div>
                <div class="led-indicator" id="breadboard-led">
                    <img class="led-light" id="breadboard-led-img" alt="LED status" />
                    <div class="led-label">LED OFF</div>
                </div>
                <div class="breadboard-note">Goal: Turn on the LED using logic gates.</div>
                <div class="oscilloscope">
                    <div class="oscilloscope-header">
                        <span>Logic Analyzer</span>
                        <span>A / B / OUT</span>
                    </div>
                    <canvas id="breadboard-scope"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="process-window">
    <div id="process-title-bar">
        <div class="window-title"><img class="title-icon" src="src/process-manager.png" alt="Process Manager logo">Process Manager</div>
        <div class="window-controls">
            <div class="control-btn min-btn" onclick="minimizeProcessManager()"></div>
            <div class="control-btn close-btn" onclick="closeProcessManager()"></div>
        </div>
    </div>
    <div id="process-content">
        <div class="process-list">
            <div class="process-row" data-kind="cpu">
                <div class="process-name">studying.c</div>
                <div class="process-meta">37% CPU</div>
                <div class="process-bar">
                    <div class="process-bar-fill" data-base="37"></div>
                </div>
            </div>
            <div class="process-row" data-kind="cpu">
                <div class="process-name">debugging.c</div>
                <div class="process-meta">120% CPU</div>
                <div class="process-bar">
                    <div class="process-bar-fill" data-base="120"></div>
                </div>
            </div>
            <div class="process-row warning" data-kind="warn">
                <div class="process-name">procrastination.js</div>
                <div class="process-meta">memory leak detected ⚠️</div>
                <div class="process-bar">
                    <div class="process-bar-fill warning" data-base="85"></div>
                </div>
            </div>
            <div class="process-row" data-kind="cpu-negative">
                <div class="process-name">sleeping.py</div>
                <div class="process-meta">-12% CPU</div>
                <div class="process-bar">
                    <div class="process-bar-fill negative" data-base="-12"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="datasheet-modal" onclick="closeDatasheet(event)">
    <div class="datasheet-content" onclick="event.stopPropagation()">
        <button class="datasheet-close" onclick="closeDatasheet(event)">&times;</button>
        <div class="datasheet-header">
            <div class="datasheet-logo">MANIXH SEMICONDUCTOR</div>
            <div class="datasheet-title">BREADBOARD-1000</div>
            <div class="datasheet-subtitle">Digital Logic Simulation Module</div>
        </div>
        <div class="datasheet-body">
            <div class="datasheet-section">
                <div class="datasheet-section-title">1. GENERAL DESCRIPTION</div>
                <p style="font-size: 12px; line-height: 1.6;">
                    The BREADBOARD-1000 is a high-performance digital logic simulation device designed for 
                    educational and prototyping applications. Features include multiple logic gate configurations 
                    with real-time oscilloscope visualization.
                </p>
            </div>
            <div class="datasheet-section">
                <div class="datasheet-section-title">2. ABSOLUTE MAXIMUM RATINGS</div>
                <table class="datasheet-table">
                    <tr>
                        <td>Supply Voltage (V<sub>DD</sub>)</td>
                        <td>5.0V DC</td>
                    </tr>
                    <tr>
                        <td>Operating Temperature (T<sub>A</sub>)</td>
                        <td>25°C</td>
                    </tr>
                    <tr>
                        <td>Logic Propagation Delay (t<sub>pd</sub>)</td>
                        <td>&lt;10ns</td>
                    </tr>
                    <tr>
                        <td>Input High Voltage (V<sub>IH</sub>)</td>
                        <td>3.5V - 5.0V</td>
                    </tr>
                    <tr>
                        <td>Input Low Voltage (V<sub>IL</sub>)</td>
                        <td>0V - 0.8V</td>
                    </tr>
                    <tr>
                        <td>Maximum Clock Frequency (f<sub>MAX</sub>)</td>
                        <td>100 MHz</td>
                    </tr>
                </table>
            </div>
            <div class="datasheet-section">
                <div class="datasheet-section-title">3. LOGIC GATE SPECIFICATIONS</div>
                <table class="datasheet-table">
                    <tr>
                        <td>Supported Gates</td>
                        <td>AND, OR, XOR, NAND, NOR, XNOR, NOT</td>
                    </tr>
                    <tr>
                        <td>IC Package Emulation</td>
                        <td>74LS Series (DIP-14)</td>
                    </tr>
                    <tr>
                        <td>LED Indicator Type</td>
                        <td>High-Brightness Red (λ=630nm)</td>
                    </tr>
                    <tr>
                        <td>Scope Sample Rate</td>
                        <td>60 Hz</td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="datasheet-footer">
            © 2026 MANIXH SEMICONDUCTOR • REV 1.0 • CONFIDENTIAL
        </div>
    </div>
</div>

<div id="taskbar">
    <div class="taskbar-apps" id="taskbar-apps">
        <!-- Taskbar buttons will appear here -->
    </div>
    <div id="taskbar-clock">
        <div class="clock-time">12:00 PM</div>
        <div class="clock-date">Mon, Jan 30</div>
    </div>
</div>

<script>
    // --- START BUTTON & BIOS CONTROL ---
    let biosStarted = false;

    document.getElementById('start-button').addEventListener('click', () => {
        if (biosStarted) return;
        biosStarted = true;
        
        // Play sound from assets folder
        const audio = new Audio('assets/startup.mp3');
        audio.play().catch(err => console.log('Audio playback failed:', err));
        
        // Hide start screen and show BIOS
        document.getElementById('start-screen').style.display = 'none';
        const biosScreen = document.getElementById('bios-screen');
        biosScreen.style.display = 'flex';
        
        // Start BIOS sequence
        startBiosSequence();
    });

    // --- BIOS POST SCREEN LOGIC ---
    function startBiosSequence() {
        const biosContent = document.getElementById('bios-content');
        const biosScreen = document.getElementById('bios-screen');
        
        const biosLines = [
            { text: 'Performing Power-On Self Test...', delay: 100 },
            { text: '', delay: 50 },
            { text: 'CPU: AMD Ryzen 7 1800X @ 4.00 GHz', delay: 150, class: 'pass' },
            { text: 'Memory Test: <span class="bios-value">32768MB</span>', delay: 200, class: 'ok' },
            { text: 'Education: <span class="bios-value">University of Texas at Arlington</span>', delay: 150, class: 'ok' },
            { text: 'Skills: <span class="bios-value">Currently increasing at an apocalyptic level</span>', delay: 150, class: 'ok' },
            { text: 'RAM: <span class="bios-value">High Capacity</span>', delay: 150, class: 'ok' },
            { text: 'Storage: <span class="bios-value">4TB NVMe SSD</span>', delay: 150, class: 'ok' },
            { text: 'Graphics: <span class="bios-value">Integrated Graphics</span>', delay: 150, class: 'ok' },
            { text: '', delay: 50 },
            { text: 'Detecting IDE Drives...', delay: 200 },
            { text: 'Primary Master: <span class="bios-value">Projects Drive</span>', delay: 150, class: 'ok' },
            { text: 'Primary Slave: <span class="bios-value">Portfolio Drive</span>', delay: 150, class: 'ok' },
            { text: '', delay: 50 },
            { text: 'Initializing USB Controllers...', delay: 150, class: 'ok' },
            { text: 'Loading Operating System...', delay: 200 },
            { text: '', delay: 100 },
            { text: '<span class="bios-progress">Booting Manixh OS kernel...</span>', delay: 300 },
        ];

        let currentLine = 0;
        let cumulativeDelay = 0;
        let biosTimeouts = [];
        let biosRemoveTimeout;
        let biosSkipped = false;

        function skipBios() {
            if (biosSkipped) return;
            biosSkipped = true;
            
            // Clear all pending timeouts
            biosTimeouts.forEach(timeout => clearTimeout(timeout));
            if (biosRemoveTimeout) clearTimeout(biosRemoveTimeout);
            
            // Remove BIOS screen immediately
            biosScreen.remove();
            
            // Remove the ESC key listener
            document.removeEventListener('keydown', handleBiosEscape);
        }

        function handleBiosEscape(e) {
            if (e.key === 'Escape') {
                skipBios();
            }
        }

        // Add ESC key listener
        document.addEventListener('keydown', handleBiosEscape);

        biosLines.forEach((line, index) => {
            cumulativeDelay += line.delay;
            const timeout = setTimeout(() => {
                if (biosSkipped) return;
                const lineDiv = document.createElement('div');
                lineDiv.className = 'bios-line' + (line.class ? ' ' + line.class : '');
                lineDiv.innerHTML = line.text;
                lineDiv.style.animationDelay = '0s';
                biosContent.appendChild(lineDiv);
                
                // Auto-scroll to bottom
                biosContent.scrollTop = biosContent.scrollHeight;
            }, cumulativeDelay);
            biosTimeouts.push(timeout);
        });

        // Remove BIOS screen after animation completes
        biosRemoveTimeout = setTimeout(() => {
            if (!biosSkipped) {
                biosScreen.remove();
                document.removeEventListener('keydown', handleBiosEscape);
            }
        }, 5000);
    }

    // --- WINDOW MANAGEMENT LOGIC ---

    const windowEl = document.getElementById("draggable-window");
    const titleBar = document.getElementById("title-bar");
    const cmdInput = document.getElementById("cmdInput");
    const taskbarApps = document.getElementById("taskbar-apps");
    let terminalTaskbarButton = null;
    let currentZIndex = 100;

    // Bring terminal window to front when clicked
    windowEl.addEventListener('mousedown', () => {
        bringToFront(windowEl);
    });

    function bringToFront(window) {
        currentZIndex++;
        window.style.zIndex = currentZIndex;
    }

    function closeTerminal() {
        windowEl.style.display = "none";
        removeTaskbarButton();
    }

    function openTerminal() {
        windowEl.style.display = "flex";
        cmdInput.focus();
        addTaskbarButton();
    }

    function minimizeTerminal() {
        windowEl.style.display = "none";
        if (terminalTaskbarButton) {
            terminalTaskbarButton.classList.remove('active');
        }
    }

    function toggleTerminal() {
        if (windowEl.style.display === "none") {
            windowEl.style.display = "flex";
            cmdInput.focus();
            if (terminalTaskbarButton) {
                terminalTaskbarButton.classList.add('active');
            }
        } else {
            minimizeTerminal();
        }
    }

    function addTaskbarButton() {
        if (!terminalTaskbarButton) {
            terminalTaskbarButton = document.createElement('div');
            terminalTaskbarButton.className = 'taskbar-button active';
            terminalTaskbarButton.innerHTML = '<img class="taskbar-icon" src="src/terminal.png" alt="Terminal logo"><span>Terminal</span>';
            terminalTaskbarButton.onclick = toggleTerminal;
            taskbarApps.appendChild(terminalTaskbarButton);
        }
        terminalTaskbarButton.classList.add('active');
    }

    function removeTaskbarButton() {
        if (terminalTaskbarButton) {
            terminalTaskbarButton.remove();
            terminalTaskbarButton = null;
        }
    }

    // Update clock
    function updateClock() {
        const now = new Date();
        const hours = now.getHours() % 12 || 12;
        const minutes = now.getMinutes().toString().padStart(2, '0');
        const ampm = now.getHours() >= 12 ? 'PM' : 'AM';
        
        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        const dayName = days[now.getDay()];
        const monthName = months[now.getMonth()];
        const date = now.getDate();
        
        document.querySelector('#taskbar-clock .clock-time').textContent = `${hours}:${minutes} ${ampm}`;
        document.querySelector('#taskbar-clock .clock-date').textContent = `${dayName}, ${monthName} ${date}`;
    }
    updateClock();
    setInterval(updateClock, 1000);

    // Start with terminal open and in taskbar
    addTaskbarButton();

    // --- SNAKE GAME WINDOW MANAGEMENT ---
    const snakeWindow = document.getElementById("snake-window");
    const snakeTitleBar = document.getElementById("snake-title-bar");
    let snakeTaskbarButton = null;
    let snakeGameActive = false;

    // Bring snake window to front when clicked
    snakeWindow.addEventListener('mousedown', () => {
        bringToFront(snakeWindow);
    });

    function openSnakeGame() {
        snakeWindow.style.display = "flex";
        resizeSnakeCanvas();
        if (!snakeGameActive) {
            document.getElementById('snakeStartScreen').style.display = 'flex';
            snakeGameActive = true;
        }
        addSnakeTaskbarButton();
    }

    function resizeSnakeCanvas() {
        const maxSize = Math.min(
            window.innerWidth * 0.5,
            window.innerHeight - 300,
            380
        );
        const canvasSize = Math.floor(maxSize / 20) * 20;
        snakeCanvas.width = canvasSize;
        snakeCanvas.height = canvasSize;
    }

    function closeSnake() {
        snakeWindow.style.display = "none";
        removeSnakeTaskbarButton();
        stopSnakeGame();
        document.getElementById('snakeStartScreen').style.display = 'none';
        snakeGameActive = false;
    }

    function minimizeSnake() {
        snakeWindow.style.display = "none";
        if (snakeTaskbarButton) {
            snakeTaskbarButton.classList.remove('active');
        }
    }

    function toggleSnake() {
        if (snakeWindow.style.display === "none") {
            snakeWindow.style.display = "flex";
            if (snakeTaskbarButton) {
                snakeTaskbarButton.classList.add('active');
            }
        } else {
            minimizeSnake();
        }
    }

    function addSnakeTaskbarButton() {
        if (!snakeTaskbarButton) {
            snakeTaskbarButton = document.createElement('div');
            snakeTaskbarButton.className = 'taskbar-button active';
            snakeTaskbarButton.innerHTML = '<img class="taskbar-icon" src="src/snake.png" alt="Snake logo"><span>Snake Game</span>';
            snakeTaskbarButton.onclick = toggleSnake;
            taskbarApps.appendChild(snakeTaskbarButton);
        }
        snakeTaskbarButton.classList.add('active');
    }

    function removeSnakeTaskbarButton() {
        if (snakeTaskbarButton) {
            snakeTaskbarButton.remove();
            snakeTaskbarButton = null;
        }
    }

    // --- RESUME PDF VIEWER WINDOW MANAGEMENT ---
    const resumeWindow = document.getElementById("resume-window");
    const resumeTitleBar = document.getElementById("resume-title-bar");
    let resumeTaskbarButton = null;

    // Bring resume window to front when clicked
    resumeWindow.addEventListener('mousedown', () => {
        bringToFront(resumeWindow);
    });

    function openResume() {
        resumeWindow.style.display = "flex";
        addResumeTaskbarButton();
        bringToFront(resumeWindow);
    }

    function closeResume() {
        resumeWindow.style.display = "none";
        removeResumeTaskbarButton();
    }

    function minimizeResume() {
        resumeWindow.style.display = "none";
        if (resumeTaskbarButton) {
            resumeTaskbarButton.classList.remove('active');
        }
    }

    function toggleResume() {
        if (resumeWindow.style.display === "none") {
            resumeWindow.style.display = "flex";
            if (resumeTaskbarButton) {
                resumeTaskbarButton.classList.add('active');
            }
            bringToFront(resumeWindow);
        } else {
            minimizeResume();
        }
    }

    function addResumeTaskbarButton() {
        if (!resumeTaskbarButton) {
            resumeTaskbarButton = document.createElement('div');
            resumeTaskbarButton.className = 'taskbar-button active';
            resumeTaskbarButton.innerHTML = '<img class="taskbar-icon" src="src/resume.png" alt="Resume logo"><span>Resume</span>';
            resumeTaskbarButton.onclick = toggleResume;
            taskbarApps.appendChild(resumeTaskbarButton);
        }
        resumeTaskbarButton.classList.add('active');
    }

    function removeResumeTaskbarButton() {
        if (resumeTaskbarButton) {
            resumeTaskbarButton.remove();
            resumeTaskbarButton = null;
        }
    }

    // --- BREADBOARD WINDOW MANAGEMENT ---
    const breadboardWindow = document.getElementById("breadboard-window");
    const breadboardTitleBar = document.getElementById("breadboard-title-bar");
    let breadboardTaskbarButton = null;

    function openDatasheet(event) {
        event.stopPropagation();
        document.getElementById('datasheet-modal').style.display = 'flex';
    }

    function closeDatasheet(event) {
        event.stopPropagation();
        document.getElementById('datasheet-modal').style.display = 'none';
    }

    breadboardWindow.addEventListener('mousedown', () => {
        bringToFront(breadboardWindow);
    });

    function openBreadboard() {
        breadboardWindow.style.display = "flex";
        addBreadboardTaskbarButton();
        bringToFront(breadboardWindow);
        resizeScope();
        drawScope();
    }

    function closeBreadboard() {
        breadboardWindow.style.display = "none";
        removeBreadboardTaskbarButton();
    }

    function minimizeBreadboard() {
        breadboardWindow.style.display = "none";
        if (breadboardTaskbarButton) {
            breadboardTaskbarButton.classList.remove('active');
        }
    }

    function toggleBreadboard() {
        if (breadboardWindow.style.display === "none") {
            breadboardWindow.style.display = "flex";
            if (breadboardTaskbarButton) {
                breadboardTaskbarButton.classList.add('active');
            }
            bringToFront(breadboardWindow);
        } else {
            minimizeBreadboard();
        }
    }

    function addBreadboardTaskbarButton() {
        if (!breadboardTaskbarButton) {
            breadboardTaskbarButton = document.createElement('div');
            breadboardTaskbarButton.className = 'taskbar-button active';
            breadboardTaskbarButton.innerHTML = '<img class="taskbar-icon" src="src/breadboard.png" alt="Breadboard logo"><span>Breadboard</span>';
            breadboardTaskbarButton.onclick = toggleBreadboard;
            taskbarApps.appendChild(breadboardTaskbarButton);
        }
        breadboardTaskbarButton.classList.add('active');
    }

    function removeBreadboardTaskbarButton() {
        if (breadboardTaskbarButton) {
            breadboardTaskbarButton.remove();
            breadboardTaskbarButton = null;
        }
    }

    // --- PROCESS MANAGER WINDOW MANAGEMENT ---
    const processWindow = document.getElementById("process-window");
    const processTitleBar = document.getElementById("process-title-bar");
    let processTaskbarButton = null;

    processWindow.addEventListener('mousedown', () => {
        bringToFront(processWindow);
    });

    function openProcessManager() {
        processWindow.style.display = "flex";
        addProcessTaskbarButton();
        bringToFront(processWindow);
        startProcessAnimation();
    }

    function closeProcessManager() {
        processWindow.style.display = "none";
        removeProcessTaskbarButton();
    }

    function minimizeProcessManager() {
        processWindow.style.display = "none";
        if (processTaskbarButton) {
            processTaskbarButton.classList.remove('active');
        }
    }

    function toggleProcessManager() {
        if (processWindow.style.display === "none") {
            processWindow.style.display = "flex";
            if (processTaskbarButton) {
                processTaskbarButton.classList.add('active');
            }
            bringToFront(processWindow);
            startProcessAnimation();
        } else {
            minimizeProcessManager();
        }
    }

    function addProcessTaskbarButton() {
        if (!processTaskbarButton) {
            processTaskbarButton = document.createElement('div');
            processTaskbarButton.className = 'taskbar-button active';
            processTaskbarButton.innerHTML = '<img class="taskbar-icon" src="src/process-manager.png" alt="Process Manager logo"><span>Process Manager</span>';
            processTaskbarButton.onclick = toggleProcessManager;
            taskbarApps.appendChild(processTaskbarButton);
        }
        processTaskbarButton.classList.add('active');
    }

    function removeProcessTaskbarButton() {
        if (processTaskbarButton) {
            processTaskbarButton.remove();
            processTaskbarButton = null;
        }
    }

    // --- PROCESS MANAGER ANIMATION ---
    const processRows = document.querySelectorAll('.process-row');
    let processAnimationTimer = null;

    function updateProcessBars() {
        processRows.forEach(row => {
            const fill = row.querySelector('.process-bar-fill');
            const meta = row.querySelector('.process-meta');
            const base = parseInt(fill.dataset.base, 10) || 0;
            let value = base;

            if (row.dataset.kind === 'cpu') {
                const jitter = Math.floor(Math.random() * 10) - 4;
                value = Math.max(0, base + jitter);
                meta.textContent = `${value}% CPU`;
            } else if (row.dataset.kind === 'cpu-negative') {
                const jitter = Math.floor(Math.random() * 6) - 3;
                value = Math.min(-1, base + jitter);
                meta.textContent = `${value}% CPU`;
            } else {
                const jitter = Math.floor(Math.random() * 12) - 6;
                value = Math.max(40, base + jitter);
            }

            const width = Math.min(100, Math.abs(value));
            fill.style.width = `${width}%`;
        });
    }

    function startProcessAnimation() {
        if (processAnimationTimer) return;
        updateProcessBars();
        processAnimationTimer = setInterval(updateProcessBars, 900);
    }

    // --- BREADBOARD LOGIC GATE SIMULATOR ---
    const breadboardZone = document.getElementById('breadboard-zone');
    const breadboardSlot = document.getElementById('breadboard-slot');
    const ledIndicator = document.getElementById('breadboard-led');
    const ledLabel = ledIndicator.querySelector('.led-label');
    const ledImage = document.getElementById('breadboard-led-img');
    const scopeCanvas = document.getElementById('breadboard-scope');
    const scopeCtx = scopeCanvas.getContext('2d');
    const toggleButtons = document.querySelectorAll('.toggle-btn');
    const gateTiles = document.querySelectorAll('.gate-tile');

    // Sound Engineering
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    let humOscillator = null;
    let humGainNode = null;

    function playClickSound() {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.setValueAtTime(1200, audioContext.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(800, audioContext.currentTime + 0.05);
        
        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.05);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.05);
    }

    function startHum() {
        if (humOscillator) return;
        
        humOscillator = audioContext.createOscillator();
        humGainNode = audioContext.createGain();
        
        humOscillator.connect(humGainNode);
        humGainNode.connect(audioContext.destination);
        
        humOscillator.frequency.setValueAtTime(60, audioContext.currentTime);
        humGainNode.gain.setValueAtTime(0.015, audioContext.currentTime);
        
        humOscillator.start();
    }

    function stopHum() {
        if (!humOscillator) return;
        
        humOscillator.stop();
        humOscillator.disconnect();
        humGainNode.disconnect();
        humOscillator = null;
        humGainNode = null;
    }

    function playPopSound() {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.setValueAtTime(150, audioContext.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(50, audioContext.currentTime + 0.1);
        
        gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.15);
    }

    function playPlacementSound() {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.08);
        
        gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.1);
    }

    function playSnakeEatSound() {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        const filter = audioContext.createBiquadFilter();

        oscillator.type = 'triangle';
        filter.type = 'lowpass';
        filter.frequency.setValueAtTime(1200, audioContext.currentTime);

        oscillator.connect(filter);
        filter.connect(gainNode);
        gainNode.connect(audioContext.destination);

        oscillator.frequency.setValueAtTime(520, audioContext.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(780, audioContext.currentTime + 0.08);

        gainNode.gain.setValueAtTime(0.08, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.12);

        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.12);
    }

    function playSnakeGameOverSound() {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        const filter = audioContext.createBiquadFilter();

        oscillator.type = 'sine';
        filter.type = 'lowpass';
        filter.frequency.setValueAtTime(900, audioContext.currentTime);

        oscillator.connect(filter);
        filter.connect(gainNode);
        gainNode.connect(audioContext.destination);

        oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(120, audioContext.currentTime + 0.25);

        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.35);

        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.35);
    }

    let scopeSamplesA = [];
    let scopeSamplesB = [];
    let scopeSamplesOut = [];
    let scopeLastTime = 0;
    const scopeInterval = 60;

    const breadboardState = {
        inputA: false,
        inputB: false,
        gate: null
    };

    function createLedPng(fillColor, glowColor) {
        const size = 48;
        const canvas = document.createElement('canvas');
        canvas.width = size;
        canvas.height = size;
        const ctx = canvas.getContext('2d');

        ctx.clearRect(0, 0, size, size);

        const gradient = ctx.createRadialGradient(18, 18, 6, 24, 24, 20);
        gradient.addColorStop(0, '#ffffff');
        gradient.addColorStop(0.35, fillColor);
        gradient.addColorStop(1, '#1b1d2a');

        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(24, 24, 16, 0, Math.PI * 2);
        ctx.fill();

        ctx.strokeStyle = 'rgba(255,255,255,0.18)';
        ctx.lineWidth = 2;
        ctx.stroke();

        if (glowColor) {
            ctx.shadowBlur = 18;
            ctx.shadowColor = glowColor;
            ctx.beginPath();
            ctx.arc(24, 24, 14, 0, Math.PI * 2);
            ctx.fillStyle = fillColor;
            ctx.fill();
        }

        return canvas.toDataURL('image/png');
    }

    const ledOffSrc = createLedPng('#2f3446', null);
    const ledOnSrc = createLedPng('#00ff88', 'rgba(0,255,136,0.9)');

    function resizeScope() {
        const rect = scopeCanvas.getBoundingClientRect();
        scopeCanvas.width = Math.max(200, Math.floor(rect.width));
        scopeCanvas.height = Math.max(120, Math.floor(rect.height));
        const w = scopeCanvas.width;
        if (scopeSamplesA.length !== w) {
            scopeSamplesA = new Array(w).fill(breadboardState.inputA ? 1 : 0);
            scopeSamplesB = new Array(w).fill(breadboardState.inputB ? 1 : 0);
            scopeSamplesOut = new Array(w).fill(computeOutput() ? 1 : 0);
        }
    }

    function pushScopeSample() {
        const a = breadboardState.inputA ? 1 : 0;
        const b = breadboardState.inputB ? 1 : 0;
        const out = computeOutput() ? 1 : 0;
        scopeSamplesA.push(a);
        scopeSamplesB.push(b);
        scopeSamplesOut.push(out);
        const maxLen = scopeCanvas.width;
        if (scopeSamplesA.length > maxLen) scopeSamplesA.shift();
        if (scopeSamplesB.length > maxLen) scopeSamplesB.shift();
        if (scopeSamplesOut.length > maxLen) scopeSamplesOut.shift();
    }

    function drawScopeGrid() {
        const w = scopeCanvas.width;
        const h = scopeCanvas.height;
        scopeCtx.fillStyle = '#050608';
        scopeCtx.fillRect(0, 0, w, h);
        scopeCtx.strokeStyle = 'rgba(0, 255, 136, 0.12)';
        scopeCtx.lineWidth = 1;
        const grid = 20;
        for (let x = 0; x <= w; x += grid) {
            scopeCtx.beginPath();
            scopeCtx.moveTo(x, 0);
            scopeCtx.lineTo(x, h);
            scopeCtx.stroke();
        }
        for (let y = 0; y <= h; y += grid) {
            scopeCtx.beginPath();
            scopeCtx.moveTo(0, y);
            scopeCtx.lineTo(w, y);
            scopeCtx.stroke();
        }
    }

    function drawSignal(samples, channelIndex, color) {
        const w = scopeCanvas.width;
        const h = scopeCanvas.height;
        const padding = 10;
        const channelHeight = (h - padding * 2) / 3;
        const yTop = padding + channelIndex * channelHeight;
        const highY = yTop + channelHeight * 0.25;
        const lowY = yTop + channelHeight * 0.75;

        scopeCtx.strokeStyle = color;
        scopeCtx.lineWidth = 2;
        scopeCtx.beginPath();
        samples.forEach((value, i) => {
            const x = i;
            const y = value ? highY : lowY;
            if (i === 0) {
                scopeCtx.moveTo(x, y);
            } else {
                scopeCtx.lineTo(x, y);
            }
        });
        scopeCtx.stroke();
    }

    function drawScope() {
        resizeScope();
        drawScopeGrid();
        drawSignal(scopeSamplesA, 0, '#00ff88');
        drawSignal(scopeSamplesB, 1, '#00ff88');
        drawSignal(scopeSamplesOut, 2, '#00ff88');
    }

    function scopeLoop(timestamp) {
        if (!scopeLastTime) scopeLastTime = timestamp;
        if (timestamp - scopeLastTime >= scopeInterval) {
            pushScopeSample();
            drawScope();
            scopeLastTime = timestamp;
        }
        requestAnimationFrame(scopeLoop);
    }

    requestAnimationFrame(scopeLoop);

    gateTiles.forEach(tile => {
        tile.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', tile.dataset.gate);
        });
    });

    breadboardZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        breadboardZone.classList.add('drag-over');
    });

    breadboardZone.addEventListener('dragleave', () => {
        breadboardZone.classList.remove('drag-over');
    });

    breadboardZone.addEventListener('drop', (e) => {
        e.preventDefault();
        breadboardZone.classList.remove('drag-over');
        const gateType = e.dataTransfer.getData('text/plain');
        if (gateType) {
            setGate(gateType);
        }
    });

    toggleButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            playClickSound();
            const input = btn.dataset.input;
            if (input === 'A') {
                breadboardState.inputA = !breadboardState.inputA;
            } else if (input === 'B') {
                breadboardState.inputB = !breadboardState.inputB;
            }
            updateToggleLabels();
            updateLed();
            pushScopeSample();
            drawScope();
        });
    });

    function updateToggleLabels() {
        toggleButtons.forEach(btn => {
            const input = btn.dataset.input;
            const isOn = input === 'A' ? breadboardState.inputA : breadboardState.inputB;
            const isDisabled = btn.disabled;
            btn.classList.toggle('on', isOn && !isDisabled);
            if (isDisabled) {
                btn.textContent = `${input}: N/A`;
            } else {
                btn.textContent = `${input}: ${isOn ? 'ON' : 'OFF'}`;
            }
        });
    }

    function updateInputAvailability() {
        const isNotGate = breadboardState.gate === 'NOT';
        toggleButtons.forEach(btn => {
            if (btn.dataset.input === 'B') {
                btn.disabled = isNotGate;
                if (isNotGate) {
                    breadboardState.inputB = false;
                }
            }
        });
        updateToggleLabels();
    }

    function getGateChipLabel(gateType) {
        const labels = {
            AND: '74LS08',
            OR: '74LS32',
            XOR: '74LS86',
            XNOR: '74LS266',
            NAND: '74LS00',
            NOR: '74LS02',
            NOT: '74LS04'
        };
        return labels[gateType] || gateType;
    }

    function setGate(gateType) {
        playPlacementSound();
        breadboardState.gate = gateType;
        const chipLabel = getGateChipLabel(gateType);
        breadboardSlot.innerHTML = `
            <div class="placed-gate" data-gate="${gateType}">
                <div class="chip">
                    <div class="chip-pins">
                        <div class="chip-pin-stack">
                            <span class="chip-pin"></span>
                            <span class="chip-pin"></span>
                            <span class="chip-pin"></span>
                            <span class="chip-pin"></span>
                        </div>
                        <div class="chip-pin-stack">
                            <span class="chip-pin"></span>
                            <span class="chip-pin"></span>
                            <span class="chip-pin"></span>
                            <span class="chip-pin"></span>
                        </div>
                    </div>
                    <div class="chip-label">
                        <div class="chip-code">${chipLabel}</div>
                        <div class="chip-gate">${gateType}</div>
                    </div>
                </div>
            </div>
            <div class="slot-hint">Click gate to remove</div>
        `;
        const placedGate = breadboardSlot.querySelector('.placed-gate');
        placedGate.addEventListener('click', clearGate);
        updateInputAvailability();
        updateLed();
    }

    function clearGate() {
        breadboardState.gate = null;
        breadboardSlot.innerHTML = `
            <div>Drop a gate here</div>
            <div class="slot-hint">Drag AND, OR, XOR, XNOR, NAND, NOR, or NOT</div>
        `;
        updateInputAvailability();
        updateLed();
    }

    function clearBoard() {
        playPopSound();
        breadboardState.inputA = false;
        breadboardState.inputB = false;
        breadboardState.gate = null;
        breadboardSlot.innerHTML = `
            <div>Drop a gate here</div>
            <div class="slot-hint">Drag AND, OR, XOR, XNOR, NAND, NOR, or NOT</div>
        `;
        updateToggleLabels();
        updateInputAvailability();
        updateLed();
        pushScopeSample();
        drawScope();
    }

    function computeOutput() {
        const { inputA, inputB, gate } = breadboardState;
        if (!gate) return false;
        if (gate === 'AND') return inputA && inputB;
        if (gate === 'OR') return inputA || inputB;
        if (gate === 'XOR') return Boolean(inputA) !== Boolean(inputB);
        if (gate === 'XNOR') return Boolean(inputA) === Boolean(inputB);
        if (gate === 'NAND') return !(inputA && inputB);
        if (gate === 'NOR') return !(inputA || inputB);
        if (gate === 'NOT') return !inputA;
        return false;
    }

    function updateLed() {
        const output = computeOutput();
        ledIndicator.classList.toggle('on', output);
        ledLabel.textContent = output ? 'LED ON' : 'LED OFF';
        ledImage.src = output ? ledOnSrc : ledOffSrc;
        
        if (output) {
            startHum();
        } else {
            stopHum();
        }
    }

    updateToggleLabels();
    updateInputAvailability();
    updateLed();
    drawScope();

    window.addEventListener('resize', () => {
        if (breadboardWindow.style.display === 'flex') {
            resizeScope();
            drawScope();
        }
    });

    // Resume window drag functionality
    let isResumeDragging = false;
    let resumeOffsetX, resumeOffsetY;

    resumeTitleBar.addEventListener("mousedown", (e) => {
        isResumeDragging = true;
        resumeOffsetX = e.clientX - resumeWindow.getBoundingClientRect().left;
        resumeOffsetY = e.clientY - resumeWindow.getBoundingClientRect().top;
    });

    document.addEventListener("mousemove", (e) => {
        if (isResumeDragging) {
            resumeWindow.style.left = `${e.clientX - resumeOffsetX}px`;
            resumeWindow.style.top = `${e.clientY - resumeOffsetY}px`;
        }
    });

    document.addEventListener("mouseup", () => {
        isResumeDragging = false;
    });

    // Breadboard window drag functionality
    let isBreadboardDragging = false;
    let breadboardOffsetX, breadboardOffsetY;

    breadboardTitleBar.addEventListener("mousedown", (e) => {
        isBreadboardDragging = true;
        breadboardOffsetX = e.clientX - breadboardWindow.getBoundingClientRect().left;
        breadboardOffsetY = e.clientY - breadboardWindow.getBoundingClientRect().top;
    });

    document.addEventListener("mousemove", (e) => {
        if (isBreadboardDragging) {
            breadboardWindow.style.left = `${e.clientX - breadboardOffsetX}px`;
            breadboardWindow.style.top = `${e.clientY - breadboardOffsetY}px`;
        }
    });

    document.addEventListener("mouseup", () => {
        isBreadboardDragging = false;
    });

    // Process Manager window drag functionality
    let isProcessDragging = false;
    let processOffsetX, processOffsetY;

    processTitleBar.addEventListener("mousedown", (e) => {
        isProcessDragging = true;
        processOffsetX = e.clientX - processWindow.getBoundingClientRect().left;
        processOffsetY = e.clientY - processWindow.getBoundingClientRect().top;
    });

    document.addEventListener("mousemove", (e) => {
        if (isProcessDragging) {
            processWindow.style.left = `${e.clientX - processOffsetX}px`;
            processWindow.style.top = `${e.clientY - processOffsetY}px`;
        }
    });

    document.addEventListener("mouseup", () => {
        isProcessDragging = false;
    });

    // DRAG FUNCTIONALITY (The "OS" Feel)
    let isDragging = false;
    let offsetX, offsetY;

    titleBar.addEventListener("mousedown", (e) => {
        isDragging = true;
        // Calculate where the mouse struck the title bar relative to the window corner
        offsetX = e.clientX - windowEl.getBoundingClientRect().left;
        offsetY = e.clientY - windowEl.getBoundingClientRect().top;
    });

    document.addEventListener("mousemove", (e) => {
        if (isDragging) {
            windowEl.style.left = `${e.clientX - offsetX}px`;
            windowEl.style.top = `${e.clientY - offsetY}px`;
        }
    });

    document.addEventListener("mouseup", () => {
        isDragging = false;
    });

    // Snake window drag functionality
    let isSnakeDragging = false;
    let snakeOffsetX, snakeOffsetY;

    snakeTitleBar.addEventListener("mousedown", (e) => {
        isSnakeDragging = true;
        snakeOffsetX = e.clientX - snakeWindow.getBoundingClientRect().left;
        snakeOffsetY = e.clientY - snakeWindow.getBoundingClientRect().top;
    });

    document.addEventListener("mousemove", (e) => {
        if (isSnakeDragging) {
            snakeWindow.style.left = `${e.clientX - snakeOffsetX}px`;
            snakeWindow.style.top = `${e.clientY - snakeOffsetY}px`;
        }
    });

    document.addEventListener("mouseup", () => {
        isSnakeDragging = false;
    });

    // --- TERMINAL LOGIC (Your Existing Code) ---

    const history = document.getElementById('history');

    async function getSystemInfo() {
        const info = {};
        
        // Timezone
        info.timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
        
        // Battery API
        try {
            if ('getBattery' in navigator) {
                const battery = await navigator.getBattery();
                const percentage = Math.round(battery.level * 100);
                const isCharging = battery.charging ? 'Charging' : 'Discharging';
                info.battery = `${percentage}% (${isCharging})`;
            } else if ('battery' in navigator) {
                const battery = await navigator.battery;
                const percentage = Math.round(battery.level * 100);
                const isCharging = battery.charging ? 'Charging' : 'Discharging';
                info.battery = `${percentage}% (${isCharging})`;
            } else {
                info.battery = 'Not available';
            }
        } catch (e) {
            info.battery = 'Not available';
        }
        
        // Network Information API
        try {
            if ('connection' in navigator || 'mozConnection' in navigator || 'webkitConnection' in navigator) {
                const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
                const connectionType = connection.effectiveType || connection.type || 'Unknown';
                const downlink = connection.downlink ? connection.downlink.toFixed(2) : 'N/A';
                info.network = `${connectionType}${downlink !== 'N/A' ? ` (${downlink} Mbps)` : ''}`;
            } else {
                info.network = 'Not available';
            }
        } catch (e) {
            info.network = 'Not available';
        }
        
        // Device Memory
        try {
            if ('deviceMemory' in navigator) {
                info.memory = `${navigator.deviceMemory} GB`;
            } else {
                info.memory = 'Not available';
            }
        } catch (e) {
            info.memory = 'Not available';
        }
        
        // CPU Cores
        try {
            if ('hardwareConcurrency' in navigator) {
                info.cpu_cores = navigator.hardwareConcurrency;
            } else {
                info.cpu_cores = 'Not available';
            }
        } catch (e) {
            info.cpu_cores = 'Not available';
        }
        
        // User Agent
        const ua = navigator.userAgent;
        const os = ua.includes('Win') ? 'Windows' : ua.includes('Mac') ? 'macOS' : ua.includes('Linux') ? 'Linux' : 'Unknown';
        info.os = os;
        
        return info;
    }
    
    async function getGitHubStats() {
        const username = 'manixh-s';
        const headers = { Accept: 'application/vnd.github+json' };

        try {
            // Fetch user info
            const userRes = await fetch(`https://api.github.com/users/${username}`, { headers });
            if (!userRes.ok) throw new Error('Failed to load user info');
            const user = await userRes.json();
            
            // Fetch user repos to calculate language stats
            const reposRes = await fetch(`https://api.github.com/users/${username}/repos?per_page=100&sort=updated`, { headers });
            if (!reposRes.ok) throw new Error('Failed to load repositories');
            const repos = await reposRes.json();
            
            // Fetch user events for recent activity
            const eventsRes = await fetch(`https://api.github.com/users/${username}/events/public?per_page=100`, { headers });
            if (!eventsRes.ok) throw new Error('Failed to load events');
            const events = await eventsRes.json();
            
            // Calculate commits in last 14 days from events
            const days = 14;
            const today = new Date();
            const counts = Array(days).fill(0);
            const dayKeys = Array.from({ length: days }, (_, i) => {
                const d = new Date(today);
                d.setDate(today.getDate() - (days - 1 - i));
                return d.toISOString().slice(0, 10);
            });
            
            events.forEach(event => {
                if (event.type === 'PushEvent' && event.payload.commits) {
                    event.payload.commits.forEach(commit => {
                        const date = event.created_at?.slice(0, 10);
                        const idx = dayKeys.indexOf(date);
                        if (idx >= 0) counts[idx] += 1;
                    });
                }
            });
            
            const blocks = ['▁','▂','▃','▄','▅','▆','▇','█'];
            const maxCount = Math.max(...counts, 1);
            const sparkline = counts.map(c => blocks[Math.floor((c / maxCount) * (blocks.length - 1))]).join('');
            
            // Calculate language breakdown across all repos
            const langMap = {};
            for (const repo of repos) {
                const langRes = await fetch(`https://api.github.com/repos/${username}/${repo.name}/languages`, { headers });
                if (langRes.ok) {
                    const langs = await langRes.json();
                    Object.entries(langs).forEach(([lang, bytes]) => {
                        langMap[lang] = (langMap[lang] || 0) + bytes;
                    });
                }
            }
            
            const totalBytes = Object.values(langMap).reduce((sum, val) => sum + val, 0) || 1;
            const langLines = Object.entries(langMap)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5)
                .map(([lang, bytes]) => {
                    const pct = ((bytes / totalBytes) * 100).toFixed(1);
                    return `  - ${lang}: ${pct}%`;
                })
                .join('\n');

            return `GitHub Stats: ${username}\n\nProfile:\n  Repos: ${user.public_repos}\nActivity (last 14 days):\n  ${sparkline}\n\nTop Languages:\n${langLines || '  - No language data'}`;
        } catch (error) {
            return `GitHub stats unavailable: ${error.message}`;
        }
    }
    
    // Command Registry
    const commands = {
        help: () => `Available commands:
  about       - Who am I?
  man         - Display manual page (try: man manixh)
  skills      - Display skills (try: skills --tree)
  projects    - List my projects
  open        - Open a project (try: open <project-name>)
  resume      - View my resume
  linkedin    - Visit my LinkedIn
  github      - Visit my GitHub (try: github stats)
  sysinfo     - Show system information
  advice      - Get random life advice
  clear       - Clear the terminal
  date        - Show current time and date
  GuessNumber - Play a number guessing game
  exit        - Close the terminal window`,
        
        about: () => `I am a Computer Engineering student at UTA.
Interests: Hardware, Robotics, C/C++, Embedded Systems. 
(Try: man manixh to see full details about me)`,
        
        skills: (args) => {
            if (args === '--tree') {
                return `skills/
├── software/
│   ├── C/C++
│   ├── Python
│   ├── Embedded C
│   └── VHDL, Verilog
├── hardware/
│   ├── PCB Design (KiCad, Altium)
│   ├── Microcontrollers
│   └── Sensors
└── tools/
    ├── Git
    └── ROS (learning)`;
            } else {
                return "Usage: skills --tree";
            }
        },
        
        projects: () => {
            return `My Projects:

  • CAN-LV-Sensor   - CAN FD-based low-voltage sensor board
  • fpga-calculator   - VHDL-based calculator on FPGA

Use 'open <project-name>' to view on GitHub
Example: open CAN-LV-Sensor`;
        },
        
        open: (args) => {
            const projectLinks = {
                'CAN-LV-Sensor': 'https://github.com/Manixh-S/CAN-FD-LV-Sensor-Board',
                'fpga-calculator': 'https://github.com/manixh-s/fpga-calculator'
            };
            
            const projectName = args.toLowerCase().trim();
            
            if (!args) {
                return "Usage: open <project-name>\nTry 'projects' to see available projects.";
            } else if (projectLinks[projectName]) {
                window.open(projectLinks[projectName], '_blank');
                return `Opening ${projectName} on GitHub...`;
            } else {
                return `Project '${args}' not found. Try 'projects' to see available projects.`;
            }
        },
        
        man: (args) => {
            if (args.toLowerCase() === 'manixh') {
                return `MANIXH(1)                   User Commands                   MANIXH(1)

NAME
       Manixh - Computer Engineering student, builder

SYNOPSIS
       manixh [--build] [--learn] [--serve]

DESCRIPTION
       Interested in upgrading technology to reach higher goals with 
       humanity. Passionate about hardware, embedded systems, and creating
       solutions that make a real impact.

OPTIONS
       --build
              Build innovative hardware and software solutions

       --learn
              Continuously expand knowledge in emerging technologies

       --serve
              Apply skills to help advance human potential

EDUCATION
       University of Texas at Arlington
       Computer Engineering

INTERESTS
       Hardware Design, Robotics, C/C++, Embedded Systems, Digital Logic

SEE ALSO
       github(1), linkedin(1), resume(1)

AUTHOR
       Manish Shrestha

MANIXH(1)                    January 2026                    MANIXH(1)`;
            } else if (!args) {
                return "What manual page do you want? Try: man manixh";
            } else {
                return `No manual entry for ${args}`;
            }
        },
        
        resume: () => {
            window.open('resume.pdf', '_blank'); 
            return "Opening resume...";
        },
        
        linkedin: () => {
            window.open('https://www.linkedin.com/in/manish-shrestha-aa9075308/', '_blank');
            return "Opening LinkedIn...";
        },
        
        github: async (args) => {
            const sub = (args || '').trim().toLowerCase();
            if (sub === 'stats') {
                return await getGitHubStats();
            }
            window.open('https://github.com/manixh-s', '_blank');
            return "Opening GitHub...";
        },

        date: () => new Date().toString(),
        
        clear: () => {
            history.innerHTML = "";
            return "";
        },

        exit: () => {
            closeTerminal();
            return "Closing session...";
        },

        guessnumber: () => {
            startGuessNumberGame();
            return "Let's play Guess a Number! I'm thinking of a number between 1 and 100.\nType your guess...";
        },

        sysinfo: async () => {
            const info = await getSystemInfo();
            return `System Information:
  OS: ${info.os}
  Timezone: ${info.timezone}
  Battery: ${info.battery}
  Network: ${info.network}
  Memory: ${info.memory}
  CPU Cores: ${info.cpu_cores}`;
        },
        
        advice: async () => {
            try {
                const response = await fetch('https://api.adviceslip.com/advice');
                const data = await response.json();
                if (data.slip && data.slip.advice) {
                    return `💡 ${data.slip.advice}`;
                } else {
                    return "Could not fetch advice at this moment. Try again later.";
                }
            } catch (error) {
                return "Error fetching advice. Check your internet connection.";
            }
        }
    };

    // --- GUESS A NUMBER GAME LOGIC ---
    let gameActive = false;
    let targetNumber = 0;
    let attempts = 0;

    function startGuessNumberGame() {
        gameActive = true;
        targetNumber = Math.floor(Math.random() * 100) + 1;
        attempts = 0;
    }

    function handleGuess(guess) {
        const num = parseInt(guess);
        
        if (isNaN(num)) {
            return "Please enter a valid number!";
        }
        
        attempts++;
        
        if (num === targetNumber) {
            gameActive = false;
            return `🎉 Congratulations! You guessed it in ${attempts} attempt${attempts > 1 ? 's' : ''}!\nThe number was ${targetNumber}.\nType 'GuessNumber' to play again!`;
        } else if (num < targetNumber) {
            return `Too low! Try again. (Attempt ${attempts})`;
        } else {
            return `Too high! Try again. (Attempt ${attempts})`;
        }
    }

    // Input Handling
    cmdInput.addEventListener('keydown', async function(event) {
        if (event.key === 'Enter') {
            const fullCommand = cmdInput.value;
            const parts = fullCommand.trim().split(" ");
            const cmd = parts[0].toLowerCase();
            const args = parts.slice(1).join(" ");

            addToHistory("guest@manixh:~$ " + fullCommand);

            // Check if game is active
            if (gameActive) {
                const response = handleGuess(fullCommand.trim());
                if (response) addToHistory(response);
            } else if (cmd === "") {
            } else if (commands[cmd]) {
                const response = await commands[cmd](args);
                if (response) addToHistory(response);
            } else if (cmd === "echo") {
                 addToHistory(args);
            } else {
                addToHistory(`bash: command not found: ${cmd}`);
            }

            cmdInput.value = "";
            
            // Auto-scroll logic updated for the window container
            const contentDiv = document.getElementById('window-content');
            contentDiv.scrollTop = contentDiv.scrollHeight;
        }
    });

    function addToHistory(text) {
        const div = document.createElement('div');
        div.className = 'output';
        div.innerText = text;
        history.appendChild(div);
    }

    // --- SNAKE GAME LOGIC ---
    const snakeCanvas = document.getElementById('snakeCanvas');
    const snakeCtx = snakeCanvas.getContext('2d');
    const snakeScoreDisplay = document.getElementById('snakeScore');
    const snakeHighScoreDisplay = document.getElementById('snakeHighScore');
    const snakeTimeDisplay = document.getElementById('snakeTime');
    const snakeGameOverScreen = document.getElementById('snakeGameOver');
    const snakeRestartBtn = document.getElementById('snakeRestartBtn');

    const SNAKE_GRID_SIZE = 20;
    let SNAKE_TILE_COUNT = snakeCanvas.width / SNAKE_GRID_SIZE;

    let snake = [];
    let snakeDirection = { x: 1, y: 0 };
    let snakeNextDirection = { x: 1, y: 0 };
    let snakeFood = {};
    let snakeScore = 0;
    let snakeHighScore = parseInt(localStorage.getItem('snakeHighScore')) || 0;
    let snakeSpeed = 150;
    let snakeGameLoop;
    let snakeStartTime;
    let snakeElapsedTime = 0;
    let snakeTimeInterval;
    let snakeRunning = false;

    function initSnakeGame() {
        SNAKE_TILE_COUNT = snakeCanvas.width / SNAKE_GRID_SIZE;
        const centerX = Math.floor(SNAKE_TILE_COUNT / 2);
        const centerY = Math.floor(SNAKE_TILE_COUNT / 2);
        
        snake = [
            { x: centerX, y: centerY },
            { x: centerX - 1, y: centerY },
            { x: centerX - 2, y: centerY }
        ];
        snakeDirection = { x: 1, y: 0 };
        snakeNextDirection = { x: 1, y: 0 };
        snakeScore = 0;
        snakeSpeed = 150;
        snakeElapsedTime = 0;
        snakeRunning = true;

        snakeScoreDisplay.textContent = snakeScore;
        snakeHighScoreDisplay.textContent = snakeHighScore;
        snakeTimeDisplay.textContent = '0:00';
        snakeGameOverScreen.style.display = 'none';
        document.getElementById('snakeStartScreen').style.display = 'none';

        spawnSnakeFood();
        snakeStartTime = Date.now();
        startSnakeTimeTracking();
        startSnakeGameLoop();
    }

    function stopSnakeGame() {
        snakeRunning = false;
        if (snakeGameLoop) clearInterval(snakeGameLoop);
        if (snakeTimeInterval) clearInterval(snakeTimeInterval);
    }

    function startSnakeTimeTracking() {
        if (snakeTimeInterval) clearInterval(snakeTimeInterval);
        snakeTimeInterval = setInterval(() => {
            if (snakeRunning) {
                snakeElapsedTime = Math.floor((Date.now() - snakeStartTime) / 1000);
                const minutes = Math.floor(snakeElapsedTime / 60);
                const seconds = snakeElapsedTime % 60;
                snakeTimeDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
        }, 1000);
    }

    function startSnakeGameLoop() {
        if (snakeGameLoop) clearInterval(snakeGameLoop);
        snakeGameLoop = setInterval(updateSnake, snakeSpeed);
    }

    function spawnSnakeFood() {
        do {
            snakeFood = {
                x: Math.floor(Math.random() * SNAKE_TILE_COUNT),
                y: Math.floor(Math.random() * SNAKE_TILE_COUNT)
            };
        } while (snake.some(segment => segment.x === snakeFood.x && segment.y === snakeFood.y));
    }

    function updateSnake() {
        if (!snakeRunning) return;

        snakeDirection = { ...snakeNextDirection };

        const newHead = {
            x: snake[0].x + snakeDirection.x,
            y: snake[0].y + snakeDirection.y
        };

        if (newHead.x < 0 || newHead.x >= SNAKE_TILE_COUNT ||
            newHead.y < 0 || newHead.y >= SNAKE_TILE_COUNT) {
            snakeGameOver();
            return;
        }

        if (snake.some(segment => segment.x === newHead.x && segment.y === newHead.y)) {
            snakeGameOver();
            return;
        }

        snake.unshift(newHead);

        if (newHead.x === snakeFood.x && newHead.y === snakeFood.y) {
            snakeScore++;
            snakeScoreDisplay.textContent = snakeScore;
            playSnakeEatSound();
            
            // Check and update high score
            if (snakeScore > snakeHighScore) {
                snakeHighScore = snakeScore;
                snakeHighScoreDisplay.textContent = snakeHighScore;
                localStorage.setItem('snakeHighScore', snakeHighScore);
            }
            
            spawnSnakeFood();

            if (snakeScore % 5 === 0 && snakeSpeed > 50) {
                snakeSpeed -= 10;
                startSnakeGameLoop();
            }
        } else {
            snake.pop();
        }

        drawSnake();
    }

    function drawSnake() {
        snakeCtx.clearRect(0, 0, snakeCanvas.width, snakeCanvas.height);

        // Draw glowy grid lines
        snakeCtx.strokeStyle = 'rgba(0, 255, 136, 0.15)';
        snakeCtx.lineWidth = 1;
        snakeCtx.shadowBlur = 3;
        snakeCtx.shadowColor = 'rgba(0, 255, 136, 0.3)';
        for (let i = 0; i <= SNAKE_TILE_COUNT; i++) {
            snakeCtx.beginPath();
            snakeCtx.moveTo(i * SNAKE_GRID_SIZE, 0);
            snakeCtx.lineTo(i * SNAKE_GRID_SIZE, snakeCanvas.height);
            snakeCtx.stroke();
            snakeCtx.beginPath();
            snakeCtx.moveTo(0, i * SNAKE_GRID_SIZE);
            snakeCtx.lineTo(snakeCanvas.width, i * SNAKE_GRID_SIZE);
            snakeCtx.stroke();
        }
        snakeCtx.shadowBlur = 0;

        snakeCtx.shadowBlur = 20;
        snakeCtx.shadowColor = '#ff4444';
        snakeCtx.fillStyle = '#ff4444';
        snakeCtx.beginPath();
        snakeCtx.arc(
            snakeFood.x * SNAKE_GRID_SIZE + SNAKE_GRID_SIZE / 2,
            snakeFood.y * SNAKE_GRID_SIZE + SNAKE_GRID_SIZE / 2,
            SNAKE_GRID_SIZE / 2 - 2,
            0,
            Math.PI * 2
        );
        snakeCtx.fill();
        snakeCtx.shadowBlur = 0;

        snake.forEach((segment, index) => {
            const gradient = snakeCtx.createLinearGradient(
                segment.x * SNAKE_GRID_SIZE,
                segment.y * SNAKE_GRID_SIZE,
                (segment.x + 1) * SNAKE_GRID_SIZE,
                (segment.y + 1) * SNAKE_GRID_SIZE
            );

            if (index === 0) {
                gradient.addColorStop(0, '#00ff88');
                gradient.addColorStop(1, '#00cc6f');
                snakeCtx.shadowBlur = 15;
                snakeCtx.shadowColor = '#00ff88';
            } else {
                const alpha = 1 - (index / snake.length) * 0.5;
                gradient.addColorStop(0, `rgba(0, 255, 136, ${alpha})`);
                gradient.addColorStop(1, `rgba(0, 204, 111, ${alpha})`);
                snakeCtx.shadowBlur = 5;
                snakeCtx.shadowColor = '#00ff88';
            }

            snakeCtx.fillStyle = gradient;
            snakeCtx.fillRect(
                segment.x * SNAKE_GRID_SIZE + 1,
                segment.y * SNAKE_GRID_SIZE + 1,
                SNAKE_GRID_SIZE - 2,
                SNAKE_GRID_SIZE - 2
            );
        });
        snakeCtx.shadowBlur = 0;
    }

    function snakeGameOver() {
        snakeRunning = false;
        clearInterval(snakeGameLoop);
        clearInterval(snakeTimeInterval);

        playSnakeGameOverSound();

        document.getElementById('snakeFinalScore').textContent = snakeScore;
        document.getElementById('snakeFinalHighScore').textContent = snakeHighScore;
        const minutes = Math.floor(snakeElapsedTime / 60);
        const seconds = snakeElapsedTime % 60;
        document.getElementById('snakeFinalTime').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;

        snakeGameOverScreen.style.display = 'flex';
    }

    document.addEventListener('keydown', (e) => {
        if (!snakeRunning || snakeWindow.style.display === 'none') return;

        switch(e.key.toLowerCase()) {
            case 'w':
            case 'arrowup':
                if (snakeDirection.y === 0) snakeNextDirection = { x: 0, y: -1 };
                e.preventDefault();
                break;
            case 's':
            case 'arrowdown':
                if (snakeDirection.y === 0) snakeNextDirection = { x: 0, y: 1 };
                e.preventDefault();
                break;
            case 'a':
            case 'arrowleft':
                if (snakeDirection.x === 0) snakeNextDirection = { x: -1, y: 0 };
                e.preventDefault();
                break;
            case 'd':
            case 'arrowright':
                if (snakeDirection.x === 0) snakeNextDirection = { x: 1, y: 0 };
                e.preventDefault();
                break;
        }
    });

    snakeRestartBtn.addEventListener('click', () => {
        initSnakeGame();
    });

    document.getElementById('snakePlayBtn').addEventListener('click', () => {
        initSnakeGame();
    });

    // Handle window resize
    window.addEventListener('resize', () => {
        if (snakeWindow.style.display === 'flex') {
            resizeSnakeCanvas();
            if (snakeRunning) {
                drawSnake();
            }
        }
    });
</script>

</body>
</html>